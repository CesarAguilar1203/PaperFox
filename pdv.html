<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <title>Bootstrap Example</title>
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="inicio.css">
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
      <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <title>Bootstrap Example</title>
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="inicio.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>

  </head>
  <body>

<!-- Añade en <head> si no está aún -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

<style>
  /* Efecto hover para links con animación */
  .nav-link:hover {
    animation: pulse 0.7s;
    color: #0d6efd !important; /* Bootstrap primary color */
  }
</style>

<nav class="navbar navbar-expand-lg py-3 navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center animate__animated animate__bounceIn" href="#">
      <img src="Logo.png" width="110" height="66" class="align-middle me-2" alt="My Website" />
      <span class="fw-bold fs-3 text-white animate__animated animate__fadeInRight">PAPERFOX</span>
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#myNavbar2" aria-controls="myNavbar2" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="myNavbar2">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link fs-5 fw-semibold text-white" href="inicio.html">Inicio</a>
        </li>
        <li class="nav-item">
          <a class="nav-link fs-5 fw-semibold text-white" href="pdv.html">Inventario</a>
        </li>
        <li class="nav-item">
          <a class="nav-link fs-5 fw-semibold text-white" href="venta.html">Ventas</a>
        </li>
                            <li class="nav-item"><a href="historial_ventas.html" class="nav-link fs-5 fw-semibold text-white">Historial de ventas</a></li>
                            <li class="nav-item"><a href="resultados.html" class="nav-link fs-5 fw-semibold text-white">Solicitudes</a></li>

      </ul>
    </div>
  </div>
</nav>



  
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

  <style>
    .fila-seleccionada {
      background-color: #fff3cd !important; /* Fondo amarillo suave para edición */
    }
  </style>

<!-- Agrega en <head> -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

<!-- Contenido -->
  <style>
    .contenedor-principal {
      background: white;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgb(0 0 0 / 0.1);
      padding: 25px;
      max-width: 900px;
      margin: auto; /* centra horizontalmente */
    }

    /* Fondo amarillo suave para fila seleccionada */
    .fila-seleccionada {
      background-color: #fff3cd !important;
    }
  </style>
</head>
<body class="bg-light">

  <div class="container my-5">
    <div class="contenedor-principal">

      <div class="d-flex flex-wrap mb-3 gap-2 align-items-center">
        <input id="buscarInput" type="text" class="form-control flex-grow-1" placeholder="Buscar por nombre" />
        <button id="btnBuscar" class="btn btn-outline-primary d-flex align-items-center gap-1">
          <i class="bi bi-search"></i> Buscar
        </button>
        <button id="btnAñadir" class="btn btn-outline-success d-flex align-items-center gap-1">
          <i class="bi bi-plus-lg"></i> Añadir Producto
        </button>
        <button id="btnBorrar" class="btn btn-outline-danger d-flex align-items-center gap-1">
          <i class="bi bi-trash"></i> Borrar Seleccionado
        </button>
      </div>

      <div class="table-responsive rounded shadow-sm">
        <table id="tablaProductos" class="table table-striped table-hover table-bordered align-middle text-center">
          <thead class="table-dark">
            <tr>
              <th>Seleccionar</th>
              <th>Editar</th>
              <th>ID</th>
              <th>Nombre</th>
              <th>Categoría</th>
              <th>Precio</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- Modal para editar -->
      <div class="modal fade" id="modalEditar" tabindex="-1" aria-labelledby="modalEditarLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content shadow">
            <form id="formEditar" novalidate>
              <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="modalEditarLabel">
                  <i class="bi bi-pencil-square me-2"></i>Editar Producto
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
              </div>
              <div class="modal-body">
                <input type="hidden" id="indexFila" />
                <div class="mb-3">
                  <label for="inputID" class="form-label">ID</label>
                  <input type="text" class="form-control" id="inputID" readonly />
                </div>
                <div class="mb-3">
                  <label for="inputNombre" class="form-label">Nombre</label>
                  <input type="text" class="form-control" id="inputNombre" required />
                  <div class="invalid-feedback">Por favor ingresa un nombre.</div>
                </div>
                <div class="mb-3">
                  <label for="inputCategoria" class="form-label">Categoría</label>
                  <input type="text" class="form-control" id="inputCategoria" required />
                  <div class="invalid-feedback">Por favor ingresa una categoría.</div>
                </div>
                <div class="mb-3">
                  <label for="inputPrecio" class="form-label">Precio</label>
                  <input type="number" class="form-control" step="0.01" min="0" id="inputPrecio" required />
                  <div class="invalid-feedback">Por favor ingresa un precio válido.</div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="submit" class="btn btn-primary d-flex align-items-center gap-2">
                  <i class="bi bi-save"></i> Guardar Cambios
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const tabla = document.getElementById('tablaProductos').getElementsByTagName('tbody')[0];
    const modalEditar = new bootstrap.Modal(document.getElementById('modalEditar'));
    const formEditar = document.getElementById('formEditar');
    const inputID = document.getElementById('inputID');
    const inputNombre = document.getElementById('inputNombre');
    const inputCategoria = document.getElementById('inputCategoria');
    const inputPrecio = document.getElementById('inputPrecio');
    const buscarInput = document.getElementById('buscarInput');
    const btnBuscar = document.getElementById('btnBuscar');
    const btnAñadir = document.getElementById('btnAñadir');
    const btnBorrar = document.getElementById('btnBorrar');

    let filaSeleccionada = null;

    function cargarProductos() {
      fetch('obtener_productos.php')
        .then(res => res.json())
        .then(productos => {
          tabla.innerHTML = "";
          productos.forEach(producto => {
            const fila = tabla.insertRow();
            fila.innerHTML = `
              <td><button class="btn btn-outline-info btn-sm btnSeleccionar"><i class="bi bi-check2-circle"></i></button></td>
              <td><button class="btn btn-outline-warning btn-sm btnEditar"><i class="bi bi-pencil"></i></button></td>
              <td>${producto.id}</td>
              <td>${producto.nombre}</td>
              <td>${producto.categoria}</td>
              <td>$${parseFloat(producto.precio).toFixed(2)}</td>
            `;
          });
          actualizarEventos();
        });
    }

    function actualizarEventos() {
      document.querySelectorAll('.btnEditar').forEach(btn => {
        btn.onclick = () => {
          filaSeleccionada = btn.closest('tr');
          inputID.value = filaSeleccionada.cells[2].textContent;
          inputNombre.value = filaSeleccionada.cells[3].textContent;
          inputCategoria.value = filaSeleccionada.cells[4].textContent;
          inputPrecio.value = filaSeleccionada.cells[5].textContent.replace('$', '');
          modalEditar.show();
        };
      });

      document.querySelectorAll('.btnSeleccionar').forEach(btn => {
        btn.onclick = () => {
          if (filaSeleccionada) filaSeleccionada.classList.remove('table-primary');
          filaSeleccionada = btn.closest('tr');
          filaSeleccionada.classList.add('table-primary');
        };
      });
    }

    formEditar.addEventListener('submit', e => {
      e.preventDefault();

      if (!formEditar.checkValidity()) {
        formEditar.classList.add('was-validated');
        return;
      }

      const datos = new URLSearchParams({
        id: inputID.value,
        nombre: inputNombre.value,
        categoria: inputCategoria.value,
        precio: inputPrecio.value
      });

      fetch('guardar_producto.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: datos
      })
      .then(res => res.text())
      .then(data => {
        if (data === 'OK') {
          modalEditar.hide();
          formEditar.classList.remove('was-validated');
          cargarProductos();
        } else {
          alert('Error al guardar: ' + data);
        }
      });
    });

    btnBuscar.onclick = () => {
      const filtro = buscarInput.value.toLowerCase();
      [...tabla.rows].forEach(fila => {
        const nombre = fila.cells[3].textContent.toLowerCase();
        fila.style.display = nombre.includes(filtro) ? '' : 'none';
      });
    };

    btnAñadir.onclick = () => {
      const nombre = prompt("Nombre del producto:");
      const categoria = prompt("Categoría:");
      const precio = prompt("Precio:");

      if (nombre && categoria && precio) {
        const datos = new URLSearchParams({ nombre, categoria, precio });

        fetch('insertar_producto.php', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body: datos
        })
        .then(res => res.text())
        .then(data => {
          if (data === "OK") {
            alert("Producto añadido");
            cargarProductos();
          } else {
            alert("Error al añadir: " + data);
          }
        });
      } else {
        alert("Todos los campos son obligatorios.");
      }
    };

    btnBorrar.onclick = () => {
      if (!filaSeleccionada) {
        alert("Selecciona una fila primero.");
        return;
      }

      const id = filaSeleccionada.cells[2].textContent;
      if (!confirm("¿Estás seguro de eliminar este producto?")) return;

      fetch('eliminar_producto.php', {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams({ id })
      })
      .then(res => res.text())
      .then(data => {
        if (data === "OK") {
          alert("Producto eliminado");
          filaSeleccionada = null;
          cargarProductos();
        } else {
          alert("Error al eliminar: " + data);
        }
      });
    };

    window.onload = cargarProductos;
  </script>



  <footer
          class="text-center text-lg-start text-white"
          style="background-color: #929fba"
          >
    <!-- Grid container -->
<div class="container p-4 pb-0">
  <!-- Section: Links -->
  <section class="">
    <!--Grid row-->
    <div class="row">
      <!-- Grid column -->
      <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
        <h6 class="text-uppercase mb-4 font-weight-bold">
          PAPERFOX
        </h6>
        <p>
          Paperfox es tu proveedor confiable y punto de venta de artículos de papelería. Ofrecemos soluciones para empresas, escuelas y el hogar.
        </p>
      </div>
      <!-- Grid column -->

      <hr class="w-100 clearfix d-md-none" />

      <!-- Grid column -->
      <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mt-3">
        <h6 class="text-uppercase mb-4 font-weight-bold">Productos</h6>
        <p>
          <a class="text-white">Útiles escolares</a>
        </p>
        <p>
          <a class="text-white">Material de oficina</a>
        </p>
        <p>
          <a class="text-white">Artículos de arte</a>
        </p>
        <p>
          <a class="text-white">Papelería corporativa</a>
        </p>
      </div>
      <!-- Grid column -->

      <hr class="w-100 clearfix d-md-none" />

      <!-- Grid column -->
      <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mt-3">
        <h6 class="text-uppercase mb-4 font-weight-bold">Contacto</h6>
        <p><i class="fas fa-home mr-3"></i> Calle villa madero 992, Torreon, Mexico</p>
        <p><i class="fas fa-envelope mr-3"></i> cesaraguilar.2302082@paperfox.com</p>
        <p><i class="fas fa-phone mr-3"></i> +87 11 612 269</p>
        
      </div>
      <!-- Grid column -->

      <!-- Grid column -->
      <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mt-3">
        <h6 class="text-uppercase mb-4 font-weight-bold">Síguenos</h6>

        <!-- Facebook -->
        <a class="btn btn-primary btn-floating m-1" style="background-color: #3b5998" href="#!" role="button"
          ><i class="fab fa-facebook-f"></i></a>

        <!-- Instagram -->
        <a class="btn btn-primary btn-floating m-1" style="background-color: #ac2bac" href="#!" role="button"
          ><i class="fab fa-instagram"></i></a>

        <!-- Linkedin -->
        <a class="btn btn-primary btn-floating m-1" style="background-color: #0082ca" href="#!" role="button"
          ><i class="fab fa-linkedin-in"></i></a>
      </div>
      <!-- Grid column -->
    </div>
    <!--Grid row-->
  </section>
  <!-- Section: Links -->
</div>
<!-- Grid container -->

<!-- Copyright -->
<div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2)">
  © 2025 Paperfox
</div>
<!-- Copyright -->

    <!-- Copyright -->
  </footer>
<!-- End of .container -->
 
  </body>
</html>